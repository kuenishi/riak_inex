# Riak Import/Export

Though we already have `riak-admin backup/restore` , we don't have a
good tool to import general formats like CSV or JSON. This tool does
it.

## Build and prepare

To build and run this tool, Erlang/OTP is required.

```
$ which erl
/path/to/bin/erl
$ git clone git://github.com/kuenishi/riak_inex.git
$ cd riak_inex
$ make
```

## Run

Riak should be running.

```
$ ./inex localhost 8087 yourbucket data.csv
```

Example:

```
$ cat priv/sample.csv 
spam,ham,egg
hoge,huga,bar
$ ./inex localhost 8087 b priv/sample.csv
connecting "localhost" 8087, to import "priv/sample.csv"
2 lines imported.
```

## Check

For now keys are automatically generated by Riak. To see your data
properly imported, query to Riak:

```
$ curl 'http://localhost:8098/buckets/b/keys?keys=true'
{"keys":["XkQkGiTRhBSW43OEWgkPV3gdJmD","Ye1vSHGaTqCznevD7Su3IL0n5S3"]}
$ curl 'localhost:8098/buckets/testbucket/keys/Ye1vSHGaTqCznevD7Su3IL0n5S3'
["hoge","huga","bar"]
$ curl 'localhost:8098/buckets/testbucket/keys/XkQkGiTRhBSW43OEWgkPV3gdJmD'
["spam","ham","egg"](
```

This will take proportional to number of lines.

# TODO

- take key from first column / deterministic key generation
- schema and 2i configuration
- bulk import for JSON-per-line file
- concurrency configuration (currently 4 hardcoded)
- *export*
- 2.0 bucket types

# Relasenotes 0.0.1

- CSV support as each line for each value and keys automatically
  generated by Riak.
